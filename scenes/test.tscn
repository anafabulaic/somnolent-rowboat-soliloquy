[gd_scene load_steps=19 format=4 uid="uid://c4qe6lh0e331n"]

[ext_resource type="Material" uid="uid://c3pdan6f1jb74" path="res://materials/sky/test_sky.tres" id="1_jcd4p"]
[ext_resource type="Material" uid="uid://iidfnonygxqt" path="res://materials/dev/dev_checkerboard_dark.tres" id="2_74lek"]
[ext_resource type="PackedScene" uid="uid://bec55rns5p0a8" path="res://components/player/player.tscn" id="2_bl13t"]
[ext_resource type="Script" uid="uid://vu4en3txosrr" path="res://components/entities/physics/physics_prop.gd" id="2_j5jx5"]
[ext_resource type="ArrayOccluder3D" uid="uid://dddroubymepmm" path="res://scenes/test.occ" id="3_at5dv"]
[ext_resource type="PackedScene" uid="uid://3vafmsjb1bdh" path="res://models/levels/testlevel.glb" id="3_iyx0m"]
[ext_resource type="Resource" uid="uid://mfqndggnsmfu" path="res://plastic.tres" id="3_lpvoh"]
[ext_resource type="LightmapGIData" uid="uid://c0hha3c5hoc2d" path="res://scenes/test.lmbake" id="6_lpvoh"]

[sub_resource type="Sky" id="Sky_jcd4p"]
sky_material = ExtResource("1_jcd4p")

[sub_resource type="Environment" id="Environment_bl13t"]
background_mode = 2
sky = SubResource("Sky_jcd4p")
ambient_light_source = 3
ambient_light_color = Color(0.1592386, 0.2453078, 0.41463655, 1)
reflected_light_source = 2
sdfgi_use_occlusion = true
glow_enabled = true
glow_normalized = true
glow_mix = 0.3
glow_bloom = 1.0
glow_blend_mode = 4
fog_enabled = true
fog_mode = 1
fog_density = 1.0
fog_depth_begin = 0.0
fog_depth_end = 40.0
volumetric_fog_density = 0.1
volumetric_fog_ambient_inject = 5.0
adjustment_enabled = true
adjustment_saturation = 3.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_uacia"]
cull_mode = 2

[sub_resource type="PlaneMesh" id="PlaneMesh_bl13t"]
material = SubResource("StandardMaterial3D_uacia")
size = Vector2(0.2, 2)
subdivide_depth = 8

[sub_resource type="BoxMesh" id="BoxMesh_j5jx5"]

[sub_resource type="BoxShape3D" id="BoxShape3D_lpvoh"]

[sub_resource type="GDScript" id="GDScript_j5jx5"]
script/source = "extends RigidBody3D

@onready var origin: Vector3 = global_position
@export var translate_up: float = 3.0

var trans: float = 0.0

@onready var timer: TimeSince = TimeSince.new()

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	origin = global_position
	
	sleeping = false
	can_sleep = false
	lock_rotation = true
	freeze = true
	freeze_mode = RigidBody3D.FREEZE_MODE_KINEMATIC
	continuous_cd = true

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	global_position = origin + (Vector3.UP * trans)
	
	if timer.value > 3.0:
		hop()
		timer.reset()

func hop() -> void:
	var tween: Tween = get_tree().create_tween()
	tween.set_trans(Tween.TRANS_SPRING)
	tween.tween_property(self, \"trans\", translate_up, 0.1)
	tween.tween_property(self, \"trans\", 0.0, 0.6)
"

[sub_resource type="ArrayMesh" id="ArrayMesh_yk7ts"]
_surfaces = [{
"aabb": AABB(-0.5, -0.5, -0.5, 1, 1, 1),
"format": 34359742465,
"index_count": 36,
"index_data": PackedByteArray("AAABAAIAAAADAAEABAACAAEAAwAEAAEABQAAAAIAAwAAAAUABAAGAAIABQACAAYAAwAHAAQAAwAFAAcABwAGAAQABwAFAAYA"),
"name": "dev_checkerboard_dark",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 8,
"vertex_data": PackedByteArray("AAAAvwAAAL8AAAA/AAAAvwAAAD8AAAC/AAAAvwAAAD8AAAA/AAAAvwAAAL8AAAC/AAAAPwAAAD8AAAC/AAAAPwAAAL8AAAA/AAAAPwAAAD8AAAA/AAAAPwAAAL8AAAC/")
}]
blend_shape_mode = 0

[sub_resource type="ArrayMesh" id="ArrayMesh_j5jx5"]
resource_name = "testlevel_Cube_008"
lightmap_size_hint = Vector2i(22, 14)
_surfaces = [{
"aabb": AABB(-0.5, -0.5, -0.5, 1, 1, 1),
"attribute_data": PackedByteArray("AAAAPgAAkD+MLno/btt2PwAAAL4AAGA/AABAP7dtGz8AAAA+AABgP4wuej+3bRs/AAAAvgAAkD8AAEA/btt2PwAAAD4AAJA/jC66PCVJEj0AAAC+AABgPwAAgD6SJMk+AAAAPgAAYD+MLro8kiTJPgAAAL4AAJA/AACAPiVJEj0AAAA+AACQP0YXHT8lSRI9AAAAvgAAYD900cU+kiTJPgAAAD4AAGA/dNHFPiVJEj0AAAC+AACQP0YXHT+SJMk+AAAAPgAAkD900cU+t20bPwAAAL4AAGA/RhcdP27bdj8AAAA+AABgP3TRxT5u23Y/AAAAvgAAkD9GFx0/t20bPwAAAD4AAGA/AACAPrdtGz8AAAC+AACQP4wuujxu23Y/AAAAvgAAYD+MLro8t20bPwAAAD4AAJA/AACAPm7bdj8AAAA+AABgPwAAQD8lSRI9AAAAvgAAkD+MLno/kiTJPgAAAL4AAGA/AABAP5IkyT4AAAA+AACQP4wuej8lSRI9"),
"format": 34359742519,
"index_count": 36,
"index_data": PackedByteArray("AAABAAIAAAADAAEABAAFAAYABAAHAAUACAAJAAoACAALAAkADAANAA4ADAAPAA0AEAARABIAEAATABEAFAAVABYAFAAXABUA"),
"material": ExtResource("2_74lek"),
"name": "dev_checkerboard_dark",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 24,
"vertex_data": PackedByteArray("AAAAvwAAAL8AAAA/AAAAvwAAAD8AAAC/AAAAvwAAAD8AAAA/AAAAvwAAAL8AAAC/AAAAvwAAAL8AAAC/AAAAPwAAAD8AAAC/AAAAvwAAAD8AAAC/AAAAPwAAAL8AAAC/AAAAPwAAAL8AAAC/AAAAPwAAAD8AAAA/AAAAPwAAAD8AAAC/AAAAPwAAAL8AAAA/AAAAPwAAAL8AAAA/AAAAvwAAAD8AAAA/AAAAPwAAAD8AAAA/AAAAvwAAAL8AAAA/AAAAvwAAAL8AAAC/AAAAPwAAAL8AAAA/AAAAPwAAAL8AAAC/AAAAvwAAAL8AAAA/AAAAPwAAAD8AAAC/AAAAvwAAAD8AAAA/AAAAvwAAAD8AAAC/AAAAPwAAAD8AAAA/AAD/f/9//78AAP9//3//vwAA/3//f/+/AAD/f/9//7//////AAD/v/////8AAP+//////wAA/7//////AAD/v////3//////////f/////////9//////////3///////3//f////7//f/9/////v/9//3////+//3//f////7//fwAAAAD/v/9/AAAAAP+//38AAAAA/7//fwAAAAD/v/9///////+//3///////7//f///////v/9///////+/")
}]
blend_shape_mode = 0
shadow_mesh = SubResource("ArrayMesh_yk7ts")

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_lpvoh"]
points = PackedVector3Array(0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5)

[node name="Test" type="Node3D"]

[node name="Global" type="Node" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Global"]
environment = SubResource("Environment_bl13t")

[node name="testlevel" parent="Global" instance=ExtResource("3_iyx0m")]

[node name="templateladder_002-ladder" parent="Global/testlevel" index="13"]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, -37.5, 2, 4)

[node name="ladder_empty_002" parent="Global/testlevel/templateladder_002-ladder" index="0"]
transform = Transform3D(-4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 0, 0, 1, 0, 2, 0)

[node name="OccluderInstance3D" type="OccluderInstance3D" parent="Global"]
occluder = ExtResource("3_at5dv")

[node name="LightmapGI" type="LightmapGI" parent="Global"]
supersampling = true
bounce_indirect_energy = 2.0
light_data = ExtResource("6_lpvoh")

[node name="Lights" type="Node3D" parent="Global"]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Global/Lights"]
transform = Transform3D(1, 0, 0, 0, -0.034271605, 0.99941254, 0, -0.99941254, -0.034271605, 0, 2.133125, 0)
light_bake_mode = 1
shadow_enabled = true
shadow_reverse_cull_face = true
directional_shadow_blend_splits = true

[node name="SpotLight3D" type="SpotLight3D" parent="Global/Lights"]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, -17.939163, 3.9584742, 0.057973742)
light_energy = 2.445
light_bake_mode = 1
spot_range = 6.2791915
spot_angle = 49.819645

[node name="Player" parent="." instance=ExtResource("2_bl13t")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.197043, 4.6933346, 0)

[node name="physics" type="Node3D" parent="."]

[node name="softbodytest" type="Node3D" parent="physics"]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, -1, 0, 1, -4.371139e-08, -3.9928212, 0.33986467, -6.2916145)

[node name="SoftBody3D6" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.98027897, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
skeleton = NodePath("../SoftBody3D2")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="SoftBody3D5" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.4792881, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
skeleton = NodePath("../SoftBody3D6")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="SoftBody3D4" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.2276502, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
skeleton = NodePath("../SoftBody3D3")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="SoftBody3D3" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.72491646, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
skeleton = NodePath("../SoftBody3D2")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="SoftBody3D2" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.45132494, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="SoftBody3D" type="SoftBody3D" parent="physics/softbodytest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.19529247, 0, 0)
mesh = SubResource("PlaneMesh_bl13t")
skeleton = NodePath("../../..")
collision_layer = 0
collision_mask = 2147483651
linear_stiffness = 1.0
damping_coefficient = 1.0
ray_pickable = false
pinned_points = [19, 18]
attachments/0/point_index = 19
attachments/0/spatial_attachment_path = NodePath("")
attachments/0/offset = Vector3(0, 0, 0)
attachments/1/point_index = 18
attachments/1/spatial_attachment_path = NodePath("")
attachments/1/offset = Vector3(0, 0, 0)

[node name="littlebox" type="RigidBody3D" parent="physics"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -9.552221, 2.3788157, 0)
collision_layer = 2
collision_mask = 3
mass = 20.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="physics/littlebox"]
layers = 2
mesh = SubResource("BoxMesh_j5jx5")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics/littlebox"]
shape = SubResource("BoxShape3D_lpvoh")

[node name="jumper" type="RigidBody3D" parent="physics"]
transform = Transform3D(2.1684628, 0, 0, 0, 0.2223867, 0, 0, 0, 2.1684628, -8.497373, 0.13516617, 15.878515)
collision_layer = 2
collision_mask = 3
mass = 20.0
can_sleep = false
lock_rotation = true
freeze = true
freeze_mode = 1
script = SubResource("GDScript_j5jx5")
translate_up = 1.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="physics/jumper"]
layers = 2
mesh = SubResource("BoxMesh_j5jx5")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics/jumper"]
shape = SubResource("BoxShape3D_lpvoh")

[node name="bigbox" type="RigidBody3D" parent="physics"]
transform = Transform3D(2.8485725, 0, 0, 0, 3.9974587, 0, 0, 0, 3.983036, -8.58241, 2.0657911, -8.035668)
collision_layer = 2

[node name="MeshInstance3D" type="MeshInstance3D" parent="physics/bigbox"]
layers = 2
mesh = SubResource("BoxMesh_j5jx5")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics/bigbox"]
shape = SubResource("BoxShape3D_lpvoh")

[node name="physbox-rigid2" type="RigidBody3D" parent="physics"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.8670864, 4.9481635, 4.1290374)
collision_layer = 2
collision_mask = 3
mass = 20.0
script = ExtResource("2_j5jx5")
sound_mat = ExtResource("3_lpvoh")
metadata/_custom_type_script = "uid://vu4en3txosrr"

[node name="physbox-rigid" type="MeshInstance3D" parent="physics/physbox-rigid2"]
mesh = SubResource("ArrayMesh_j5jx5")
skeleton = NodePath("")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics/physbox-rigid2"]
shape = SubResource("ConvexPolygonShape3D_lpvoh")

[node name="physbox-rigid3" type="RigidBody3D" parent="physics"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7.8670864, 0.5, 8.679569)
collision_layer = 2
collision_mask = 3
mass = 500.0
script = ExtResource("2_j5jx5")
sound_mat = ExtResource("3_lpvoh")
metadata/_custom_type_script = "uid://vu4en3txosrr"

[node name="physbox-rigid" type="MeshInstance3D" parent="physics/physbox-rigid3"]
mesh = SubResource("ArrayMesh_j5jx5")
skeleton = NodePath("")

[node name="CollisionShape3D" type="CollisionShape3D" parent="physics/physbox-rigid3"]
shape = SubResource("ConvexPolygonShape3D_lpvoh")

[editable path="Global/testlevel"]
